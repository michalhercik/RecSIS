// Code generated by templ - DO NOT EDIT.

// templ: version: v0.2.793
package degreeplandetail

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

func scripts() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString("<script>\n\t\tsetupCheckboxShiftClick();\n\t\tupdateStickyOffset();\n\t\tinitializeTooltips();\n\t\tcleanupOffcanvasOnNavigation();\n\n\t\t// shift click for multiple checkboxes\n\t\tfunction setupCheckboxShiftClick() {\n\t\t\tlet lastChecked = null;\n\t\t\tconst checkboxes = document.querySelectorAll('input[type=\"checkbox\"][name=\"selected-courses\"]');\n\t\t\tcheckboxes.forEach(checkbox => {\n\t\t\t\tcheckbox.addEventListener('click', function (e) {\n\t\t\t\t\tif (lastChecked && lastChecked !== this && e.shiftKey) {\n\t\t\t\t\t\tlet inBetween = false;\n\t\t\t\t\t\tcheckboxes.forEach(box => {\n\t\t\t\t\t\t\tif (box === this || box === lastChecked) {\n\t\t\t\t\t\t\t\tinBetween = !inBetween;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (inBetween && box.checked !== this.checked) {\n\t\t\t\t\t\t\t\tbox.checked = this.checked;\n\t\t\t\t\t\t\t\tbox.dispatchEvent(new Event('change'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (lastChecked.checked !== this.checked) {\n\t\t\t\t\t\t\tlastChecked.checked = this.checked;\n\t\t\t\t\t\t\tlastChecked.dispatchEvent(new Event('change'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlastChecked = this;\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t// pass through (shift-)click event to checkbox\n\t\tfunction handleCircleClick(event) {\n\t\t\tconst checkbox = event.target.parentElement.previousElementSibling;\n\t\t\tif (checkbox) {\n\t\t\t\t// Create a new MouseEvent, preserving shift key and other properties\n\t\t\t\tconst clickEvent = new MouseEvent('click', {\n\t\t\t\t\tbubbles: true,\n\t\t\t\t\tcancelable: true,\n\t\t\t\t\tshiftKey: event.shiftKey,\n\t\t\t\t});\n\n\t\t\t\tcheckbox.dispatchEvent(clickEvent);\n\t\t\t}\n\t\t}\n\n\t\t// pass through click event to checkbox on small screens\n\t\tfunction handleTdClick(event) {\n\t\t\tconst checkbox = event.target.querySelector('input[type=\"checkbox\"][name=\"selected-courses\"]');\n\t\t\tif (checkbox) {\n\t\t\t\t// Create a new MouseEvent, preserving shift key and other properties\n\t\t\t\tconst clickEvent = new MouseEvent('click', {\n\t\t\t\t\tbubbles: true,\n\t\t\t\t\tcancelable: true,\n\t\t\t\t\tshiftKey: event.shiftKey,\n\t\t\t\t});\n\n\t\t\t\tcheckbox.dispatchEvent(clickEvent);\n\t\t\t}\n\t\t}\n\n\t\t// Update the sticky offset for the checked-courses-menu based on the header height\n\t\tfunction updateStickyOffset() {\n\t\t\tconst header = document.querySelector('header');\n\t\t\tconst menu = document.getElementById('dp-checked-courses-menu');\n\t\t\tif (header && menu) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tconst height = header.offsetHeight;\n\t\t\t\t\tmenu.style.top = height + 'px';\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t}\n\n\t\t// bootstrap tooltip initialization\n\t\tfunction initializeTooltips() {\n\t\t\t// Initialize new tooltips\n\t\t\tconst tooltipTriggerList = document.querySelectorAll('[data-bs-toggle=\"tooltip\"]')\n\t\t\tconst tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))\n\t\t};\n\n\t\t// Add checked courses to BP btn can add only to the union of not yet assigned semesters of all checked courses \n\t\tfunction updateCheckedCoursesMenu(semesterCount) {\n\t\t\tconst checkedCourses = Array.from(document.querySelectorAll('input[type=\"checkbox\"][name=\"selected-courses\"]:checked'));\n\t\t\tconst disabledSemesters = Array(semesterCount).fill(false);\n\n\t\t\tcheckedCourses.forEach(checkbox => {\n\t\t\t\t// Get the table row\n\t\t\t\tconst row = checkbox.closest('tr');\n\t\t\t\tif (!row) return;\n\t\t\t\t// Get the last td (blueprint button cell)\n\t\t\t\tconst lastTd = row.querySelector('td:last-child');\n\t\t\t\tif (!lastTd) return;\n\n\t\t\t\t// Find the assign to unassigned button\n\t\t\t\tconst plusBtn = lastTd.querySelector('button.assign-to-unassigned-btn');\n\t\t\t\tif (plusBtn && plusBtn.disabled) {\n\t\t\t\t\t// Mark first semester (unassigned) as disabled\n\t\t\t\t\tdisabledSemesters[0] = true;\n\t\t\t\t}\n\n\t\t\t\t// Find dropdown items (semester assign buttons)\n\t\t\t\tconst dropdownItems = lastTd.querySelectorAll('.dropdown-menu .dropdown-item');\n\t\t\t\tdropdownItems.forEach((item, idx) => {\n\t\t\t\t\tif (item.disabled) {\n\t\t\t\t\t\t// Mark this semester as disabled\n\t\t\t\t\t\tdisabledSemesters[idx + 1] = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconsole.log('Disabled semesters:', disabledSemesters);\n\n\t\t\t// Now update the checked-courses-menu buttons\n\t\t\tconst menu = document.getElementById('dp-checked-courses-menu');\n\t\t\tif (!menu) return;\n\t\t\tconst innerDiv = menu.querySelector('div > div');\n\t\t\tif (!innerDiv) return;\n\n\t\t\t// Update the assign-to-unassigned button (first semester)\n\t\t\tconst assignBtn = innerDiv.querySelector('button.assign-to-unassigned-btn');\n\t\t\tif (assignBtn) {\n\t\t\t\tassignBtn.disabled = disabledSemesters[0];\n\t\t\t}\n\n\t\t\t// Update dropdown items (other semesters)\n\t\t\tconst dropdownItems = innerDiv.querySelectorAll('.dropdown-menu .dropdown-item');\n\t\t\tdropdownItems.forEach((item, idx) => {\n\t\t\t\tif (idx < disabledSemesters.length) {\n\t\t\t\t\titem.disabled = disabledSemesters[idx + 1];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Close offcanvas before HTMX navigation and on browser back\n\t\tfunction cleanupOffcanvasOnNavigation() {\n\t\t\tdocument.body.addEventListener('htmx:beforeRequest', function(event) {\n\t\t\t\tconst offcanvasElement = document.getElementById('dp-offcanvas-menu');\n\t\t\t\tif (offcanvasElement && offcanvasElement.classList.contains('show')) {\n\t\t\t\t\tconst bsOffcanvas = bootstrap.Offcanvas.getInstance(offcanvasElement);\n\t\t\t\t\tif (bsOffcanvas) {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tbsOffcanvas.hide();\n\t\t\t\t\t\t// Wait for the offcanvas to fully close, then trigger the request again\n\t\t\t\t\t\toffcanvasElement.addEventListener('hidden.bs.offcanvas', function() {\n\t\t\t\t\t\t\thtmx.trigger(event.detail.elt, 'click');\n\t\t\t\t\t\t}, { once: true });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Initialize the requisite graph using Cytoscape.js\n\t\tfunction initializeRequisiteGraph() {\n\t\t\tconst graphContainer = document.getElementById('course-graph');\n\t\t\tif (!graphContainer) return;\n\n\t\t\tconst graphData = buildGraphData();\n\t\t\t\n\t\t\tconst cy = cytoscape({\n\t\t\t\tcontainer: graphContainer,\n\t\t\t\tlayout: {\n\t\t\t\t\tname: 'elk',\n\t\t\t\t\telk: {\n\t\t\t\t\t\talgorithm: 'layered',\n\t\t\t\t\t\t'elk.direction': 'UP',\n\t\t\t\t\t\t'spacing.nodeNode': 30,\n\t\t\t\t\t\t'spacing.nodeNodeBetweenLayers': 35,\n\t\t\t\t\t\t'spacing.edgeNodeBetweenLayers': 40,\n\t\t\t\t\t\t'layering.strategy': 'LONGEST_PATH',\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\telements: graphData,\n\t\t\t\tstyle: [\n\t\t\t\t\t{\n\t\t\t\t\t\tselector: 'node',\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t'label': 'data(label)',\n\t\t\t\t\t\t\t'text-valign': 'center',\n\t\t\t\t\t\t\t'text-halign': 'center',\n\t\t\t\t\t\t\t'background-color': 'rgb(252,227,204)',\n\t\t\t\t\t\t\t'color': '#000',\n\t\t\t\t\t\t\t'text-wrap': 'wrap',\n\t\t\t\t\t\t\t'text-max-width': 120,\n\t\t\t\t\t\t\t'font-size': 11,\n\t\t\t\t\t\t\t'font-weight': 'bold',\n\t\t\t\t\t\t\t'shape': 'round-rectangle',\n\t\t\t\t\t\t\t'width': 'label',\n\t\t\t\t\t\t\t'height': 'label',\n\t\t\t\t\t\t\t'padding': '10px'\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tselector: 'node[inPlan=\"false\"]',\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t'background-color': '#ccc',\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tselector: 'edge[type=\"prerequisite\"]',\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t'line-color': '#1f77b4',\n\t\t\t\t\t\t\t'target-arrow-color': '#1f77b4',\n\t\t\t\t\t\t\t'target-arrow-shape': 'triangle',\n\t\t\t\t\t\t\t'curve-style': 'bezier'\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tselector: 'edge[type=\"corequisite\"]',\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t'line-color': '#2ca02c',\n\t\t\t\t\t\t\t'target-arrow-color': '#2ca02c',\n\t\t\t\t\t\t\t'target-arrow-shape': 'triangle',\n\t\t\t\t\t\t\t'curve-style': 'bezier'\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tselector: 'edge[type=\"incompatibility\"]',\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t'line-color': '#d62728',\n\t\t\t\t\t\t\t'target-arrow-color': '#d62728',\n\t\t\t\t\t\t\t'target-arrow-shape': 'triangle',\n\t\t\t\t\t\t\t'curve-style': 'straight'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t});\n\n\t\t\t// Fit the graph to the canvas after layout completes\n\t\t\tcy.on('layoutstop', function() {\n\t\t\t\tcy.fit(cy.elements(), 50);\n\t\t\t});\n\n\t\t\t// Click handler\n\t\t\tcy.on('tap', 'node', (evt) => {\n\t\t\t\tconst code = evt.target.data('code');\n\t\t\t\twindow.location.href = `/course/${code}`;\n\t\t\t});\n\n\t\t\t// Cursor handlers\n\t\t\tcy.on('mouseover', 'node', function() {\n\t\t\t\tgraphContainer.style.cursor = 'pointer';\n\t\t\t});\n\t\t\tcy.on('mouseout', 'node', function() {\n\t\t\t\tgraphContainer.style.cursor = 'default';\n\t\t\t});\n\n\t\t\t// Enable scroll and zoom\n\t\t\tenableGraphScrollAndZoom(cy, graphContainer);\n\n\t\t\t// Filter handlers\n\t\t\tsetupGraphFilters(cy);\n\t\t}\n\n\t\t// Build graph data from server-side data\n\t\tfunction buildGraphData() {\n\t\t\t// This is populated from server-side data\n\t\t\tconst dataElement = document.getElementById('graph-data');\n\t\t\tif (dataElement) {\n\t\t\t\treturn JSON.parse(dataElement.textContent);\n\t\t\t}\n\t\t\treturn { nodes: [], edges: [] };\n\t\t}\n\n\t\tfunction setupGraphFilters(cy) {\n\t\t\tconst prereqCheckbox = document.getElementById('show-prerequisites');\n\t\t\tconst coreqCheckbox = document.getElementById('show-corequisites');\n\t\t\tconst incompatCheckbox = document.getElementById('show-incompatibilities');\n\n\t\t\tfunction applyFilters() {\n\t\t\t\tcy.edges().forEach(edge => {\n\t\t\t\t\tconst type = edge.data('type');\n\t\t\t\t\tlet visible = true;\n\t\t\t\t\t\n\t\t\t\t\tif (type === 'prerequisite') visible = prereqCheckbox.checked;\n\t\t\t\t\tif (type === 'corequisite') visible = coreqCheckbox.checked;\n\t\t\t\t\tif (type === 'incompatibility') visible = incompatCheckbox.checked;\n\n\t\t\t\t\tedge.style('display', visible ? 'element' : 'none');\n\t\t\t\t});\n\n\t\t\t\t// Hide nodes without visible edges\n\t\t\t\tcy.nodes().forEach(node => {\n\t\t\t\t\tconst connectedEdges = node.connectedEdges();\n\t\t\t\t\tlet hasVisibleEdges = false;\n\t\t\t\t\t\n\t\t\t\t\tconnectedEdges.forEach(edge => {\n\t\t\t\t\t\tconst type = edge.data('type');\n\t\t\t\t\t\tif (type === 'prerequisite' && prereqCheckbox.checked) hasVisibleEdges = true;\n\t\t\t\t\t\tif (type === 'corequisite' && coreqCheckbox.checked) hasVisibleEdges = true;\n\t\t\t\t\t\tif (type === 'incompatibility' && incompatCheckbox.checked) hasVisibleEdges = true;\n\t\t\t\t\t});\n\n\t\t\t\t\tnode.style('display', hasVisibleEdges ? 'element' : 'none');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tprereqCheckbox?.addEventListener('change', applyFilters);\n\t\t\tcoreqCheckbox?.addEventListener('change', applyFilters);\n\t\t\tincompatCheckbox?.addEventListener('change', applyFilters);\n\n\t\t\tapplyFilters();\n\t\t}\n\n\t\t// Allow normal page scrolling on wheel, but zoom graph when shift is held\n\t\tfunction enableGraphScrollAndZoom(cy, graphContainer) {\n\t\t\tcy.userZoomingEnabled(false);\n\t\t\tconst zoomStep = 0.1;\n\t\t\tconst minZoom = cy.minZoom();\n\t\t\tconst maxZoom = cy.maxZoom();\n\n\t\t\tgraphContainer.addEventListener('wheel', (event) => {\n\t\t\t\tif (!event.shiftKey) {\n\t\t\t\t\treturn; // let the page handle scroll normally\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tconst bounds = graphContainer.getBoundingClientRect();\n\t\t\t\tconst renderedPosition = {\n\t\t\t\t\tx: event.clientX - bounds.left,\n\t\t\t\t\ty: event.clientY - bounds.top,\n\t\t\t\t};\n\n\t\t\t\tconst zoomDelta = event.deltaY < 0 ? 1 + zoomStep : 1 - zoomStep;\n\t\t\t\tconst newZoom = Math.max(minZoom, Math.min(maxZoom, cy.zoom() * zoomDelta));\n\n\t\t\t\tcy.zoom({\n\t\t\t\t\tlevel: newZoom,\n\t\t\t\t\trenderedPosition,\n\t\t\t\t});\n\t\t\t}, { passive: false });\n\t\t}\n\t</script>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return templ_7745c5c3_Err
	})
}

var _ = templruntime.GeneratedTemplate
